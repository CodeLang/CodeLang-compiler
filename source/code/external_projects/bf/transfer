#!/bin/zsh
source ~/.zshrc

function transcompile {
    unilang --input_files $1.unilang --exporter UBER --languages JAVA --style NORMAL --build-only;
    transfer $2 $3;
}

function transcompile_test {
    unilang --input_files $1.unilang --exporter UBER --languages JAVA_TEST --style NORMAL --build-only;
    transfer $2 $3;
}

function transfer {
    cp $1.java $2;
    rm $1.java;
    cd ~/Desktop/bazel-buildfarm;
    .bazelci/format.sh
    cd -;
    #java -jar ~/Desktop/java_formatter.jar -i "${2}""${1}".java
}

#redis queues
#transcompile redis_queue RedisQueue ~/Desktop/bazel-buildfarm/src/main/java/build/buildfarm/instance/shard/queues/
#transcompile_test redis_queue RedisQueueTest ~/Desktop/bazel-buildfarm/src/test/java/build/buildfarm/instance/shard/queues/
#transfer RedisQueueMockTest ~/Desktop/bazel-buildfarm/src/test/java/build/buildfarm/instance/shard/queues/

#balanced queues
#transcompile balanced_redis_queue BalancedRedisQueue ~/Desktop/bazel-buildfarm/src/main/java/build/buildfarm/instance/shard/queues/
#transcompile_test balanced_redis_queue BalancedRedisQueueTest ~/Desktop/bazel-buildfarm/src/test/java/build/buildfarm/instance/shard/queues/
#transfer BalancedRedisQueueMockTest ~/Desktop/bazel-buildfarm/src/test/java/build/buildfarm/instance/shard/queues/

# transcompile redis_provision_queue RedisProvisionQueue ~/Desktop/bazel-buildfarm/src/main/java/build/buildfarm/instance/shard/queues/
# transcompile_test redis_provision_queue RedisProvisionQueueTest ~/Desktop/bazel-buildfarm/src/test/java/build/buildfarm/instance/shard/queues/

#transcompile      provisioned_redis_queue ProvisionedRedisQueue   ~/Desktop/bazel-buildfarm/src/main/java/build/buildfarm/common/redis/
#transcompile_test provisioned_redis_queue ProvisionedRedisQueueTest ~/Desktop/bazel-buildfarm/src/test/java/build/buildfarm/common/redis/

#transcompile      filtered_provisions FilteredProvisions   ~/Desktop/bazel-buildfarm/src/main/java/build/buildfarm/common/redis/
#transcompile      eligibility_result EligibilityResult   ~/Desktop/bazel-buildfarm/src/main/java/build/buildfarm/common/redis/

transcompile      time Time   ~/Desktop/bazel-buildfarm/src/main/java/build/buildfarm/common/

#transcompile operation_queue OperationQueue ~/Desktop/bazel-buildfarm/src/main/java/build/buildfarm/instance/shard/

#transcompile cas_indexer CasIndexer ~/Desktop/bazel-buildfarm/src/main/java/build/buildfarm/instance/shard/

#transcompile redis_slot_to_hash RedisSlotToHash ~/Desktop/bazel-buildfarm/src/main/java/build/buildfarm/common/redis/
#transcompile_test redis_slot_to_hash RedisSlotToHashTest ~/Desktop/bazel-buildfarm/src/test/java/build/buildfarm/common/redis/

# transcompile redis_node_hashes RedisNodeHashes ~/Desktop/bazel-buildfarm/src/main/java/build/buildfarm/instance/shard/queues/
# transcompile_test redis_node_hashes RedisNodeHashesTest ~/Desktop/bazel-buildfarm/src/test/java/build/buildfarm/instance/shard/queues/
# transfer RedisNodeHashesMockTest ~/Desktop/bazel-buildfarm/src/test/java/build/buildfarm/instance/shard/queues/

# transcompile string_visitor StringVisitor ~/Desktop/bazel-buildfarm/src/main/java/build/buildfarm/common/


#shard backplane
# transcompile jedis_cluster_factory JedisClusterFactory ~/Desktop/bazel-buildfarm/src/main/java/build/buildfarm/instance/shard/



#missing java automations:
# - correct package name
# - forwarding constructors
# - better test mocking